document.addEventListener("DOMContentLoaded",(function(){function e(t,o){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];console.log("Fetching IP from: ".concat(t)),fetch(t).then((function(e){if(console.log("Response status:",e.status),!e.ok)throw new Error("Response not OK");return e.json()})).then((function(e){var t;if(console.log("API Response:",e),c)t=e.ip;else if(e.Answer&&e.Answer.length>0){var n=e.Answer[0];if(1===n.type)t=n.data;else if(5===n.type){console.log("Resolving CNAME: ".concat(n.data));var r="https://dns.google/resolve?name=".concat(n.data,"&type=A");return fetch(r).then((function(e){if(!e.ok)throw new Error("CNAME Response not OK");return e.json()})).then((function(e){if(console.log("CNAME API Response:",e),!(e.Answer&&e.Answer.length>0))throw new Error("CNAME IP not found");t=e.Answer[0].data,document.getElementById(o).textContent="IP: ".concat(t)}))}}if(!t)throw new Error("IP not found");document.getElementById(o).textContent="IP: ".concat(t)})).catch((function(t){console.error("Error fetching IP:",t),n?(console.log("Trying backup URL: ".concat(n)),e(n,o,c)):document.getElementById(o).textContent="Failed to load IP"}))}e("https://ipinfo.io/json?token=709d1e6ff8b4dd","ip","https://ipgeolocation.abstractapi.com/v1/?api_key=580fefff964843d29ace169cf28648ff",!0),browser.tabs.query({active:!0,currentWindow:!0}).then((function(t){if(t[0]&&t[0].url){var o=new URL(t[0].url),n="https://dns.google/resolve?name=".concat(o.hostname,"&type=A");console.log("Fetching site IP for: ".concat(o.hostname)),console.log("DNS API URL: ".concat(n)),e(n,"site-ip")}else console.error("No active tab found or tab URL is not available"),document.getElementById("site-ip").textContent="Failed to get site IP"})).catch((function(e){console.error("Error querying tabs:",e),document.getElementById("site-ip").textContent="Failed to get site IP"})),document.getElementById("clearSelected").addEventListener("click",(function(){var e;e=Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map((function(e){return e.name})),browser.storage.local.set({dataTypes:e}),browser.runtime.sendMessage({type:"clearCache"})})),document.getElementById("toggleDarkMode").addEventListener("click",(function(){var e=document.body.classList.toggle("dark-mode");document.documentElement.classList.toggle("dark-mode",e),browser.storage.local.set({darkMode:e})})),browser.storage.local.get("darkMode").then((function(e){e.darkMode&&(document.body.classList.add("dark-mode"),document.documentElement.classList.add("dark-mode"))}));var t=!1;document.getElementById("toggleSelect").addEventListener("click",(function(){t=!t,document.querySelectorAll('.checkbox-container input[type="checkbox"]').forEach((function(e){e.checked=t}))}))}));